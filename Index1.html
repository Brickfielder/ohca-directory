<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UK Air Ambulance Services Map</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
      html, body {
        height: 100%;
        margin: 0;
      }
      #map {
        width: 100%;
        height: 100%;
      }
      .popup-content {
        font-family: Arial, sans-serif;
        font-size: 14px;
        line-height: 1.4;
      }
      .popup-content strong {
        font-size: 16px;
      }
      .popup-section {
        margin-bottom: 8px;
      }
    </style>
</head>
<body>
    <div id="map"></div>
    <div id="search-container" style="position: absolute; top: 10px; left: 50px; z-index: 1000; background: rgba(255,255,255,0.9); padding: 5px 8px; border-radius: 4px; box-shadow: 0 0 6px rgba(0,0,0,0.3);">
      <input type="text" id="search-box" placeholder="Search services..." style="width: 200px; padding: 4px; font-size: 14px;" list="services-list" />
      <datalist id="services-list"></datalist>
    </div>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
      const airAmbulances = [
  { id: "aani", name: "Air Ambulance Northern Ireland", lat: 54.4888, lng: -6.0927, followUp: "No (informal only)", eligibility: "Not specified", description: "No formal aftercare programme. Keeps in touch via community events and story-sharing initiatives.", contact: "info@airambulanceni.org", sourceLink: "https://airambulanceni.org" },
  { id: "scaa", name: "Scotland's Charity Air Ambulance", lat: 56.395, lng: -3.431, followUp: "No (no programme)", eligibility: "NHS follow-up only", description: "No dedicated aftercare service; patients supported by NHS. Charity highlights former patient stories for awareness.", contact: "info@scaa.org.uk", sourceLink: "https://www.scaa.org.uk" },
  { id: "waa", name: "Wales Air Ambulance Charity", lat: 52.414, lng: -4.082, followUp: "Yes", eligibility: "All patients and families treated", description: "Two Patient Liaison Nurses provide continuity of care with hospital/home visits, emotional support, and bereavement support.", contact: "contact@walesairambulance.com", sourceLink: "https://www.walesairambulance.com" },
  { id: "laac", name: "London's Air Ambulance Charity", lat: 51.519, lng: -0.061, followUp: "Yes", eligibility: "All trauma patients treated", description: "Patient Liaison Nurses support patients through discharge and rehabilitation, explain treatments, connect to resources, and host private support group.", contact: "info@londonsairambulance.org.uk", sourceLink: "https://www.londonsairambulance.org.uk" },
  { id: "ehaat", name: "Essex & Herts Air Ambulance", lat: 51.721, lng: 0.155, followUp: "Yes", eligibility: "All patients treated", description: "Two Patient Liaison Managers meet patients at home or hospital, fill memory gaps, answer questions, arrange base visits, and signpost to further support.", contact: "info@ehaat.org", sourceLink: "https://www.ehaat.org" },
  { id: "eaaa", name: "East Anglian Air Ambulance (Norwich & Cambridge)", lat: 52.63, lng: 1.297, followUp: "Yes", eligibility: "All patients and families treated", description: "EAAA operates a dedicated Aftercare Team of clinicians providing tailored support to former patients, friends and families. They offer home visits, base visits, check-ins, peer support groups, and provide emotional and bereavement support.", contact: "aftercare@eaaa.org.uk | 01223 403600", sourceLink: "https://www.eaaa.org.uk" },
  { id: "kss", name: "Kent Surrey Sussex Air Ambulance", lat: 51.213, lng: -0.135, followUp: "Yes", eligibility: "Patients and bereaved families", description: "Patient & Family Aftercare Service launched 2022, offering tailored support, peer contact, bereavement support, and crew engagement.", contact: "patients@aakss.org.uk", sourceLink: "https://www.aakss.org.uk" },
  { id: "gwaac", name: "Great Western Air Ambulance Charity", lat: 51.454, lng: -2.587, followUp: "Yes", eligibility: "All patients and families treated", description: "Patient Support service helps patients piece together events, meet crews, and provides emotional/bereavement support.", contact: "info@gwaac.com", sourceLink: "https://www.greatwesternairambulance.com" },
  { id: "maac", name: "Midlands Air Ambulance Charity", lat: 52.497, lng: -2.284, followUp: "Yes", eligibility: "All patients and families treated", description: "Launched 2024. Patient Liaison Team offers emotional and practical support, connects with clinicians, and supports bereaved families.", contact: "patient.liaison@midlandsairambulance.com", sourceLink: "https://www.midlandsairambulance.com" },
  { id: "yaa", name: "Yorkshire Air Ambulance", lat: 53.675, lng: -1.406, followUp: "Yes", eligibility: "All patients treated (opt-in)", description: "Patient & Family Support initiative invites former patients/families to reach out for support, explains care, facilitates crew contact, and offers feedback opportunities.", contact: "patientcare@yaa.org.uk", sourceLink: "https://www.yaa.org.uk" },
  { id: "lnaa", name: "Lincs & Notts Air Ambulance", lat: 53.175, lng: -0.525, followUp: "Yes", eligibility: "Anyone affected by incident", description: "Aftercare Team supports patients, families, friends, and bystanders; arranges base visits; answered 900+ follow-ups in 2023.", contact: "aftercare@ambucopter.org.uk", sourceLink: "https://www.ambucopter.org.uk" },
  { id: "magpas", name: "Magpas Air Ambulance", lat: 52.33, lng: -0.18, followUp: "No (informal only)", eligibility: "Not specified", description: "Hosts base visits/reunions and engages former patients through events. No dedicated liaison staff; relies on voluntary contact.", contact: "info@magpas.org.uk", sourceLink: "https://www.magpas.org.uk" },
  { id: "tvaa", name: "Thames Valley Air Ambulance", lat: 51.616, lng: -0.748, followUp: "Yes", eligibility: "All patients and families treated", description: "Aftercare Team proactively contacts patients/families, offers emotional support, explains treatment, and signposts to further help.", contact: "info@tvairambulance.org.uk", sourceLink: "https://www.tvairambulance.org.uk" },
  { id: "hiowaa", name: "Hampshire & Isle of Wight Air Ambulance", lat: 51.211, lng: -1.604, followUp: "Yes", eligibility: "Patients, families, bystanders", description: "Aftercare Team of paramedics and nurses offers post-incident explanation, emotional support, bereavement support, and links to resources.", contact: "info@hiowaa.org", sourceLink: "https://www.hiowaa.org" },
  { id: "daa", name: "Devon Air Ambulance", lat: 50.716, lng: -3.53, followUp: "Yes", eligibility: "Patients and families treated", description: "Patient & Family Support Team offers emotional support, answers care questions, arranges crew follow-up meetings, and signposts to services.", contact: "daat@daat.org", sourceLink: "https://www.daat.org" },
  { id: "caa", name: "Cornwall Air Ambulance", lat: 50.441, lng: -4.995, followUp: "No (informal only)", eligibility: "Not specified", description: "No dedicated aftercare team; invites patients to share stories, become ambassadors, and engage in events.", contact: "info@cornwallairambulancetrust.org", sourceLink: "https://cornwallairambulancetrust.org" },
  { id: "dsaa", name: "Dorset & Somerset Air Ambulance", lat: 51.004, lng: -2.357, followUp: "Yes", eligibility: "Patients, families, bystanders", description: "Patient & Family Liaison Nurses provide support, home visits, bereavement support, and answer questions post-incident.", contact: "info@dsairambulance.org.uk", sourceLink: "https://www.dsairambulance.org.uk" },
  { id: "gnaas", name: "Great North Air Ambulance Service", lat: 54.66, lng: -2.86, followUp: "No formal programme", eligibility: "Not specified", description: "No structured aftercare team; former patients may reconnect ad hoc to share updates. Focus mainly on fundraising stories.", contact: "enquiries@gnaas.com", sourceLink: "https://www.greatnorthairambulance.co.uk" },
  { id: "nwaac", name: "North West Air Ambulance Charity", lat: 53.481, lng: -2.272, followUp: "Yes", eligibility: "All patients treated", description: "Aftercare Service run with major trauma hospitals. Provides guidance, hospital-based support, and connects patients to crews.", contact: "enquiries@nwaa.net", sourceLink: "https://www.nwaa.net" },
  { id: "dlraa", name: "Derbyshire, Leicestershire & Rutland Air Ambulance", lat: 52.9, lng: -1.2, followUp: "Yes", eligibility: "All patients treated", description: "Provides Patient & Family Aftercare via Clinical Liaison Officer. Offers support, emotional care, and links to clinicians.", contact: "support@theairambulanceservice.org.uk", sourceLink: "https://theairambulanceservice.org.uk" },
  { id: "wnaa", name: "Warwickshire & Northamptonshire Air Ambulance", lat: 52.33, lng: -1.17, followUp: "Yes", eligibility: "All patients treated", description: "Part of The Air Ambulance Service. Clinical Liaison Officer bridges on-scene care and recovery support.", contact: "support@theairambulanceservice.org.uk", sourceLink: "https://theairambulanceservice.org.uk" }
];

      const map = L.map('map').setView([54.5, -3], 6);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
      }).addTo(map);

      const helicopterIcon = L.divIcon({
        html: '<span style="font-size:24px">üöÅ</span>',
        className: '',
        iconSize: [24, 24],
        iconAnchor: [12, 12],
        popupAnchor: [0, -12]
      });

      const markersLayer = new L.LayerGroup().addTo(map);
const allMarkers = [];
const latlngs = [];

      airAmbulances.forEach(service => {
        const marker = L.marker([service.lat, service.lng], {
          icon: helicopterIcon,
          title: service.name
        });
        const popupContent = `
          <div class="popup-content">
            <div class="popup-section"><strong>${service.name}</strong></div>
            <div class="popup-section"><em>Follow-up care:</em> ${service.followUp}</div>
            <div class="popup-section"><em>Eligibility:</em> ${service.eligibility}</div>
            <div class="popup-section"><em>Description:</em> ${service.description}</div>
            <div class="popup-section"><em>Contact:</em> ${service.contact}</div>
            <div class="popup-section"><em>Source:</em> <a href="${service.sourceLink}" target="_blank">${service.sourceLink}</a></div>
          </div>
        `;
        marker.bindPopup(popupContent);
        markersLayer.addLayer(marker);
        allMarkers.push({ name: service.name, marker: marker });
  latlngs.push([service.lat, service.lng]);
      });

// Fit map to bounds of all air ambulance markers
if (latlngs.length) {
  map.fitBounds(latlngs, { padding: [30, 30] });
}

const servicesList = document.getElementById('services-list');
      allMarkers.forEach(item => {
        const opt = document.createElement('option');
        opt.value = item.name;
        servicesList.appendChild(opt);
      });

      const searchBox = document.getElementById('search-box');
      function performSearch() {
        const query = searchBox.value.trim().toLowerCase();
        if (!query) return;
        const match = allMarkers.find(item => item.name.toLowerCase().includes(query));
        if (match) {
          const latlng = match.marker.getLatLng();
          map.setView(latlng, 11);
          match.marker.openPopup();
        }
      }
      searchBox.addEventListener('change', performSearch);
      searchBox.addEventListener('keyup', function(e) {
        if (e.key === 'Enter') {
          performSearch();
        }
      });
    </script>
</body>
</html>
